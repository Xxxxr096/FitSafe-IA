<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>FitSafe AI - Tableau de bord</title>

  <!-- TailwindCSS & Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet" />
  <link rel="icon" type="image/png" href="{{ url_for('static', filename='image/logo2.png') }}">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    body { font-family: "Poppins", sans-serif; }
    select, input, button { transition: all 0.2s ease-in-out; }
    .nav-link-glow {
      font-weight: 700;
      background: linear-gradient(90deg, #ef4444, #ff006e, #00ffff, #ef4444);
      background-size: 300%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      animation: glow-shift 3s linear infinite;
      text-shadow: 0 0 10px rgba(255,255,255,0.3);
      transition: transform 0.3s ease;
    }
  
    .nav-link-glow:hover {
      transform: scale(1.15);
      text-shadow: 0 0 20px rgba(255,255,255,0.6);
    }
  
    @keyframes glow-shift {
      0% { background-position: 0%; }
      100% { background-position: 300%; }
    }
    /* ---- Effet de survol n√©on universel pour tous les boutons et liens importants ---- */
    button,
    a.bg-red-600,
    a.bg-neutral-700,
    a.text-red-500,
    a.text-neutral-400,
    .bg-red-600,
    .bg-neutral-700 {
      transition: all 0.3s ease-in-out;
    }

    button:hover,
    a.bg-red-600:hover,
    a.bg-neutral-700:hover,
    a.text-red-500:hover,
    a.text-neutral-400:hover,
    .bg-red-600:hover,
    .bg-neutral-700:hover {
      transform: scale(1.08);
      filter: drop-shadow(0 0 8px rgba(239, 68, 68, 0.8));
    }

  </style>
</head>

<body class="bg-neutral-950 text-white min-h-screen flex flex-col">
  <!-- ===== NAVBAR ===== -->
  <header class="fixed top-0 w-full z-50 bg-neutral-900/80 backdrop-blur-md border-b border-neutral-800">
    <div class="max-w-7xl mx-auto flex items-center justify-between px-6 py-4">
      <h1 class="text-2xl font-orbitron font-bold text-red-500 tracking-wide">
        FitSafe <span class="nav-link-glow">IA</span>
      </h1>
      
      <nav class="hidden md:flex space-x-8 text-sm font-medium">
        <a href="{{ url_for('home') }}" class="hover:text-red-500 transition">Accueil</a>
        <a href="{{ url_for('dashboard') }}" class="text-red-500 font-semibold">Tableau de bord</a>
        <a href="{{ url_for('advis') }}" class="hover:text-red-500 transition">Conseils</a>
        <a href="{{ url_for('profil') }}" class="hover:text-red-500 transition">Profil</a>
        <a href="{{ url_for('contact') }}" class="hover:text-red-500 transition">Contact</a>
        <a href="{{ url_for('ia') }}" class="nav-link-glow">IA</a>
        <a href="{{ url_for('humain') }}" class="nav-link-glow hover:text-red-400 transition">
          Humain
        </a>

      </nav>
      <a href="{{ url_for('logout') }}" class="text-sm text-neutral-400 hover:text-red-500 transition">Se d√©connecter</a>
      <button class="md:hidden text-white"><i data-lucide="menu"></i></button>
    </div>
  </header>
  <!-- ===== FLASH MESSAGES ===== -->
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <div id="flash-container" class="fixed top-4 right-4 space-y-3 z-50">
          {% for category, message in messages %}
            <div class="flash-message flex items-center gap-3 px-4 py-3 rounded-lg shadow-lg border text-sm
                        {% if category == 'error' %}bg-red-800/90 border-red-600 text-red-100
                        {% elif category == 'success' %}bg-green-800/90 border-green-600 text-green-100
                        {% elif category == 'warning' %}bg-yellow-700/90 border-yellow-500 text-yellow-100
                        {% else %}bg-neutral-800/90 border-neutral-600 text-neutral-200{% endif %}">
              <i data-lucide="{% if category == 'error' %}x-circle{% elif category == 'success' %}check-circle{% elif category == 'warning' %}alert-triangle{% else %}info{% endif %}" class="w-5 h-5"></i>
              <span>{{ message }}</span>
            </div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}

  <!-- ===== MAIN CONTENT ===== -->
  <main class="flex-1 pt-24 pb-16 px-6 md:px-12 max-w-7xl mx-auto space-y-10">

    <!-- üëã Bienvenue -->
    <section>
      <h2 class="text-3xl md:text-4xl font-bold">
        Bienvenue, <span class="text-red-500">{{ current_user.nom if current_user.is_authenticated else 'Invit√©' }} üí™</span>
      </h2>
      <p class="text-neutral-400 mt-2">Voici ton √©tat de forme et ton suivi d‚Äôentra√Ænement.</p>
    </section>
  
    <!-- üéØ S√©lection de s√©ance -->
    <section class="flex flex-col md:flex-row md:items-center justify-between gap-4 bg-neutral-900 border border-neutral-800 rounded-2xl p-5 shadow-lg">
      <form method="GET" action="{{ url_for('dashboard') }}" class="flex gap-3 items-center">
        <label for="session_id" class="text-neutral-400 text-sm">S√©ance :</label>
        <select name="session_id" id="session_id"
                class="bg-neutral-800 border border-neutral-700 rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-red-600">
          <option value="">Toutes les s√©ances</option>
          {% for s in sessions %}
          <option value="{{ s.id }}" {% if selected_session and s.id == selected_session.id %}selected{% endif %}>
            {{ s.name }}
          </option>
          {% endfor %}
        </select>
        <button type="submit" class="bg-red-600 hover:bg-red-700 px-4 py-2 rounded-lg font-semibold">Afficher</button>
      </form>
  
      <form action="{{ url_for('add_session') }}" method="POST" class="flex gap-2 items-center">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <input type="text" name="name" placeholder="Nouvelle s√©ance"
               class="bg-neutral-800 border border-neutral-700 rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-green-600"
               required>
        <button type="submit" class="bg-green-600 hover:bg-green-700 px-4 py-2 rounded-lg font-bold">+</button>
      </form>
    </section>
  
    <!-- üß† Dashboard principal -->
    <section class="grid grid-cols-1 lg:grid-cols-3 gap-8">
  
      <!-- Graph de progression -->
      <div class="lg:col-span-2 bg-neutral-900 rounded-2xl p-6 shadow-lg border border-neutral-800">
        <div class="flex justify-between items-center mb-4">
          <h3 class="text-xl font-semibold">Progression de l‚Äôentra√Ænement</h3>
          <i data-lucide="line-chart" class="w-6 h-6 text-red-500"></i>
        </div>
        <div class="h-64 bg-neutral-800 rounded-xl p-4">
          <canvas id="workoutChart"></canvas>
        </div>
      </div>
  
      <!-- Risque de blessure -->
      <div class="bg-neutral-900 rounded-2xl p-6 shadow-lg border border-neutral-800 flex flex-col justify-between">
        <h3 class="text-xl font-semibold mb-4 flex items-center gap-2">
          <i data-lucide="alert-triangle" class="text-red-500"></i>
          Risque de blessure actuel
        </h3>
        <div class="flex justify-center items-center h-40">
          {% if risk_score %}
            {% if risk_score < 30 %}
              <div class="w-32 h-32 rounded-full flex items-center justify-center text-2xl font-bold text-green-400 border-4 border-green-500">
                {{ risk_score }}%
              </div>
            {% elif risk_score < 70 %}
              <div class="w-32 h-32 rounded-full flex items-center justify-center text-2xl font-bold text-yellow-400 border-4 border-yellow-500">
                {{ risk_score }}%
              </div>
            {% else %}
              <div class="w-32 h-32 rounded-full flex items-center justify-center text-2xl font-bold text-red-400 border-4 border-red-500">
                {{ risk_score }}%
              </div>
            {% endif %}
          {% else %}
            <div class="text-neutral-500">Pas encore de donn√©es üß†</div>
          {% endif %}
        </div>
        <p class="text-center text-neutral-400 text-sm mt-4">
          {{ risk_message or "Les recommandations appara√Ætront ici apr√®s tes premi√®res s√©ances." }}
        </p>
      </div>
    </section>
    <!-- üí™ Score de forme -->
    <section class="bg-neutral-900 rounded-2xl p-6 shadow-lg border border-neutral-800 text-center">
      <h3 class="text-xl font-semibold mb-3 flex justify-center items-center gap-2">
        <i data-lucide="heart-pulse" class="text-red-500"></i>
        Score de forme 
      </h3>

      {% if fitness_score %}
        <div class="text-5xl font-bold {% if fitness_score > 75 %}text-green-400{% elif fitness_score > 50 %}text-yellow-400{% else %}text-red-400{% endif %}">
          {{ fitness_score }}%
        </div>
        <p class="text-neutral-400 mt-2 text-sm">Calcul√© selon ta charge, ta r√©gularit√© et ton risque de blessure.</p>
      {% else %}
        <p class="text-neutral-500 italic">Pas assez de donn√©es pour √©valuer ton score.</p>
      {% endif %}
    </section>

    <!-- Analyse IA -->
    <section class="mt-10 bg-neutral-900 p-8 rounded-2xl border border-neutral-800 text-center">
      <h3 class="text-2xl font-bold mb-4">Analyse IA üß†</h3>

      <p class="text-red-500 text-lg font-semibold">
        Risque actuel : {{ risk_score }}%
      </p>

      <p class="text-neutral-400 mt-2">
        {{ risk_message }}
      </p>

      <p class="text-neutral-400 italic mt-1">
        {{ focus_message }}
      </p>

      {% if weather %}
        <p class="text-sm text-neutral-500 mt-3">
          M√©t√©o actuelle : {{ weather.temp }}¬∞C ({{ weather.condition }})
        </p>
      {% endif %}
    </section>

    
    <!-- üìã S√©ances et exercices -->
    <!-- üìã S√©ances et exercices -->
<section class="bg-neutral-900 rounded-2xl p-6 border border-neutral-800">
  <h3 class="text-xl font-semibold mb-6 flex items-center gap-2">
    <i data-lucide="activity" class="text-red-500"></i> Suivi de tes s√©ances
  </h3>

  {% if sessions %}
  {% for s in sessions if s and s.id %}
    <div class="mb-6 bg-neutral-800 rounded-xl p-5 shadow-inner">
      <div class="flex justify-between items-center cursor-pointer" onclick="toggleSession(this)">
        <h4 class="text-lg font-semibold text-red-400 flex items-center gap-2">
          <i data-lucide="calendar"></i> {{ s.name }}
        </h4>
        <button class="toggle-btn text-neutral-400 hover:text-red-400 transition">
          <i data-lucide="chevron-down"></i>
        </button>
      </div>

      <!-- üóëÔ∏è Bouton suppression de la s√©ance -->
      <form action="{{ url_for('delete_session', id=s.id) }}" method="POST"
            onsubmit="return confirm('Supprimer cette s√©ance et tous ses exercices ?');">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <button type="submit"
                class="bg-red-600 hover:bg-red-700 text-white text-xs font-semibold px-3 py-1 rounded-lg transition">
          Supprimer la s√©ance üóëÔ∏è
        </button>
      </form>


        {% set workouts_for_session = workouts | selectattr("session_id", "equalto", s.id) | list %}
        <div class="exercise-list mt-4 space-y-3">
          {% if workouts_for_session %}
            <ul class="space-y-3">
              {% for w in workouts_for_session %}
                <li class="flex justify-between items-center border-b border-neutral-700 pb-2 text-neutral-300">
                  <div>
                    <span class="font-medium">{{ w.exercise }}</span>
                    <span class="text-neutral-400 text-sm">
                      ‚Äî {{ w.series }} s√©ries x {{ w.reps }} reps ({{ w.duration }} min)
                    </span>
                  </div>

                  <div class="text-green-400 text-sm font-semibold">
                    üî• {{ calories_par_exercice[w.id] }} kcal
                  </div>

                  <form action="{{ url_for('delete_workout', id=w.id) }}" method="POST"
                        onsubmit="return confirm('Supprimer cet exercice ?');">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                    <button type="submit" class="text-neutral-400 hover:text-red-500 transition">
                      <i data-lucide="trash-2"></i>
                    </button>
                  </form>
                </li>
              {% endfor %}
            </ul>
          {% else %}
            <p class="text-neutral-500 italic">Aucun exercice ajout√© pour cette s√©ance.</p>
          {% endif %}
        </div>
      </div>
    {% endfor %}
  {% else %}
    <p class="text-neutral-500 italic">Aucune s√©ance enregistr√©e pour l‚Äôinstant.</p>
  {% endif %}
</section>

  <!-- üèãÔ∏è Ajouter un exercice -->
<section class="bg-neutral-900 rounded-2xl p-6 border border-neutral-800">
    <h3 class="text-xl font-semibold mb-4 flex items-center gap-2">
      <i data-lucide="plus-circle" class="text-red-500"></i> Ajouter un exercice
    </h3>
  
    <form action="{{ url_for('add_workout') }}" method="POST" class="grid grid-cols-1 md:grid-cols-6 gap-4">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

      <!-- Choix de la s√©ance -->
      <div>
        <label for="session_id" class="block text-sm mb-1 text-neutral-400">S√©ance</label>
        <select name="session_id" id="session_id_form" required
                class="w-full bg-neutral-800 border border-neutral-700 rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-red-600">
          {% for s in sessions %}
          <option value="{{ s.id }}">{{ s.name }}</option>
          {% endfor %}
        </select>
      </div>
  
      <!-- Type d'entra√Ænement -->
      <div>
        <label for="type" class="block text-sm mb-1 text-neutral-400">Type d'entra√Ænement</label>
        <select name="type" id="type" required
                class="w-full bg-neutral-800 border border-neutral-700 rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-red-600"
                onchange="updateExercises()">
          <option value="">Choisir...</option>
          <option value="Pectoraux">Pectoraux</option>
          <option value="Dos">Dos</option>
          <option value="Jambes">Jambes</option>
          <option value="√âpaules">√âpaules</option>
          <option value="Avant_Bras">Avant bras</option>
          <option value="Abdominaux">Abdominaux</option>
          <option value="Biceps">Biceps</option>
          <option value="Triceps">Triceps</option>
          <option value="Cardio">Cardio</option>
        </select>
      </div>
  
      <!-- Exercice dynamique -->
      <div>
        <label for="exercise" class="block text-sm mb-1 text-neutral-400">Exercice</label>
        <select name="exercise" id="exercise" required
                class="w-full bg-neutral-800 border border-neutral-700 rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-red-600">
          <option value="">Choisir un exercice</option>
        </select>
      </div>
  
      <!-- S√©ries -->
      <div>
        <label for="series" class="block text-sm mb-1 text-neutral-400">S√©ries</label>
        <input type="number" name="series" id="series" min="1" required
               class="w-full bg-neutral-800 border border-neutral-700 rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-red-600">
      </div>
  
      <!-- R√©p√©titions -->
      <div>
        <label for="reps" class="block text-sm mb-1 text-neutral-400">R√©p√©titions</label>
        <input type="number" name="reps" id="reps" min="1" required
               class="w-full bg-neutral-800 border border-neutral-700 rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-red-600">
      </div>
  
      <!-- Dur√©e -->
      <div>
        <label for="duration" class="block text-sm mb-1 text-neutral-400">Dur√©e (min)</label>
        <input type="number" name="duration" id="duration" min="5" required
               class="w-full bg-neutral-800 border border-neutral-700 rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-red-600">
      </div>
  
      <!-- Bouton -->
      <div class="flex items-end">
        <button type="submit" class="w-full bg-red-600 hover:bg-red-700 font-semibold py-2 px-4 rounded-lg transition">
          Ajouter
        </button>
      </div>
    </form>
  </section>
  
  <!-- Script pour les exercices dynamiques -->
  <script>
    const exercisesByType = {
      "Pectoraux":[
        "D√©velopp√© couch√© barre",
        "D√©velopp√© couch√© halt√®res",
        "D√©velopp√© inclin√© barre",
        "D√©velopp√© inclin√© halt√®res",
        "D√©velopp√© d√©clin√© barre",
        "D√©velopp√© d√©clin√© halt√®res",
        "√âcart√©s couch√©s halt√®res",
        "√âcart√©s inclin√©s halt√®res",
        "√âcart√©s d√©clin√©s halt√®res",
        "√âcart√©s √† la poulie vis-√†-vis basse",
        "√âcart√©s √† la poulie vis-√†-vis haute",
        "Cross-over √† la poulie (debout)",

        "Pompes classiques",
        "Pompes d√©clin√©es",
        "Pompes inclin√©es",
        "Pompes sur√©lev√©es",
        "Dips (pectoraux, buste pench√©)",
    
        
        "D√©velopp√© couch√© √† la machine (Smith Machine)",
        "D√©velopp√© inclin√© √† la machine",
        "D√©velopp√© d√©clin√© √† la machine",
        "D√©velopp√© √† la machine convergente (Hammer Strength)",
        "D√©velopp√© √† la machine convergente Technogym",
    
        
        "√âcart√© √† la machine Pec Deck (Butterfly)",
        "√âcart√© assis √† la machine convergente",
        "√âcart√© couch√© √† la machine",
        "√âcart√© inclin√© √† la machine",
    
        
        "Crossover √† la poulie vis-√†-vis haute",
        "Crossover √† la poulie vis-√†-vis basse",
        "√âcart√© √† la poulie unilat√©rale",
        "Press √† la poulie debout",
    
        
        "Pompes sur anneaux",
        "Pompes TRX",
        "√âcart√© TRX",
        "D√©velopp√© halt√®res sur ballon de gym",
        "Pompes lest√©es",
        "Pompes explosives / pliom√©triques",
        "Pompes diamant (diamond push-up)",
        "Pompes Spiderman",
        "Pompes unilat√©rales"
        ],
      "Dos": [
        "Rowing barre pronation",
        "Rowing barre supination",
        "Rowing halt√®re un bras",
        "Rowing halt√®res deux bras sur banc inclin√©",
        "Rowing Yates (prise supination)",
        "Rowing T-bar",
        "Rowing avec kettlebell",
        "Rowing invers√© avec barre",
    
        "Soulev√© de terre classique",
        "Soulev√© de terre sumo",
        "Soulev√© de terre jambes tendues",
        "Pull-over halt√®res",
        "Shrugs halt√®res",
        "Shrugs barre",
    
        "Tirage horizontal machine",
        "Tirage assis poulie basse",
        "Tirage unilat√©ral machine convergente",
        "Row machine Hammer Strength",
        "Row assis Technogym",
        "Tirage horizontal c√¢ble neutre",
    
        "Tirage vertical poulie haute (large)",
        "Tirage vertical poulie prise serr√©e",
        "Tirage vertical unilat√©ral",
        "Lat Pulldown convergent",
        "Tirage vertical assist√©",
        "Tirage prise supination (chin pulldown)",
    
        "Tractions pronation",
        "Tractions supination",
        "Tractions neutres",
        "Tractions lest√©es",
        "Tractions barre fixe",
        "Tractions australiennes (row invers√©)",
        "Pont dos (back bridge)",
        "Superman au sol",
        "Reverse plank",
        "Tractions TRX / anneaux",
        "Rowing invers√© TRX",
    
        
        "Tirage poulie unilat√©ral",
        "Row poulie basse unilat√©ral",
        "Tirage poulie haute un bras",
        "Face pull (tirage vis-√†-vis visage)",
        "Pullover poulie haute bras tendus",
        "Tirage droit bras tendus (standing cable pulldown)",
        "Crossover dos (vis-√†-vis invers√©)",
        "Shrugs poulie basse",
    
    
        "Soulev√© de terre trap bar",
        "Rowing bande √©lastique",
        "Face pull bande √©lastique",
        "Tirage vertical √©lastique",
        "TRX Row",
        "Kettlebell swing"
    ],
      "Jambes": [
      
      "Squat barre libre",
      "Front squat (squat avant)",
      "Squat goblet",
      "Squat sumo",
      "Squat bulgare (split squat)",
      "Squat gobelet sur banc",
      "Fente avant squat",
      "Overhead squat",
      "Zercher squat",
  
     
      "Fente avant halt√®res",
      "Fente arri√®re halt√®res",
      "Fentes march√©es",
      "Fentes sur place",
      "Fentes bulgares",
      "Fentes lat√©rales",
      "Fentes avec barre",
      "Fentes crois√©es (curtsy lunge)",
  
      
      "Soulev√© de terre jambes tendues",
      "Soulev√© de terre roumain",
      "Soulev√© de terre halt√®res",
      "Soulev√© de terre sumo",
      "Soulev√© de terre trap bar",
  
      
      "Hip thrust barre",
      "Hip thrust halt√®res",
      "Step-up sur banc",
      "Good morning",
      "Jefferson squat",
      "Kettlebell swing",
  
     
      "Presse √† cuisses",
      "Extension de jambes machine",
      "Hack squat machine",
      "Squat guid√© (Smith machine)",
      "Sissy squat machine",
      "Belt squat",
  
      
      "Leg curl allong√©",
      "Leg curl assis",
      "Glute machine (kickback)",
      "Hip thrust machine",
      "Abducteur machine",
      "Adducteur machine",
      "Glute drive machine",
  
    
      "Mollets debout machine",
      "Mollets assis machine",
      "Mollets √† la presse √† cuisses",
      "Mollets √† la Smith machine",
  
     
      "Squat poids du corps",
      "Fente poids du corps",
      "Fentes saut√©es",
      "Squat saut (jump squat)",
      "Squat sumo sans charge",
      "Mont√©es de genoux",
      "Step-up sans charge",
      "Pont fessier au sol",
      "Extension hanche au sol",
      "Pont jambes tendues",
      "Fente pliom√©trique",
      "Wall sit (squat isom√©trique)",
  
    
      "Kickback poulie basse",
      "√âl√©vation lat√©rale jambe poulie",
      "Fente avant poulie",
      "Pull-through poulie basse",
      "Tirage arri√®re poulie basse",
      "Abduction hanche poulie",
      "Adduction hanche poulie",
  
    
      "Squat TRX",
      "Fente TRX",
      "Pont fessier TRX",
      "Curl ischio TRX",
      "Kettlebell swing",
      "Box jump",
      "Pistol squat",
      "Bulgarian squat TRX",
      "Abduction bande √©lastique",
      "Adduction bande √©lastique",
      "Extension hanche √©lastique",
      "Step-up √©lastique"
  ],
      "√âpaules": [
     
      "D√©velopp√© militaire barre",
      "D√©velopp√© militaire halt√®res",
      "D√©velopp√© assis halt√®res",
      "D√©velopp√© nuque barre",
      "Arnold press",
      "Push press (barre ou halt√®res)",
      "D√©velopp√© unilat√©ral halt√®re",
      "D√©velopp√© debout halt√®res",
  
  
      "√âl√©vations lat√©rales halt√®res",
      "√âl√©vations frontales halt√®res",
      "√âl√©vations lat√©rales un bras",
      "√âl√©vations frontales altern√©es",
      "√âl√©vations lat√©rales pench√©es",
      "√âl√©vations lat√©rales assises",
      "√âl√©vations frontales barre EZ",
      "√âl√©vations lat√©rales inclin√©es sur banc",
  
      
      "Oiseau halt√®res (rear delt fly)",
      "Oiseau assis halt√®res",
      "Oiseau sur banc inclin√©",
      "Rowing menton prise large",
      "Rowing debout prise serr√©e (upright row)",
      "Rowing vertical barre EZ",
      "Face pull avec √©lastique (version halt√®res possible)",
      "Reverse fly halt√®res",
  
  
      "D√©velopp√© √©paules machine",
      "D√©velopp√© √©paules Smith machine",
      "Presse √©paules machine convergente",
      "√âl√©vations lat√©rales machine",
      "√âl√©vations frontales machine",
      "√âcart√© invers√© machine (reverse pec deck)",
      "Rowing vertical machine",
      "Shrugs machine",
      "D√©velopp√© unilat√©ral machine",
  
      
      "√âl√©vations lat√©rales poulie basse",
      "√âl√©vations frontales poulie",
      "Oiseau poulie crois√©e (crossover invers√©)",
      "Face pull poulie haute",
      "Rowing menton poulie basse",
      "D√©velopp√© √©paules poulie",
      "√âl√©vations diagonales c√¢ble crois√©",
      "√âl√©vations lat√©rales poulie un bras",
  
  
      "Pike push-up (pompes en V)",
      "Pompes en handstand",
      "Pompes murales √©paules",
      "Pompes TRX inclin√©es",
      "Handstand hold contre mur",
      "Pompes sur√©lev√©es (accent √©paules)",
  
      
      "Face pull TRX",
      "√âl√©vations lat√©rales √©lastique",
      "√âl√©vations frontales √©lastique",
      "Oiseau √©lastique",
      "D√©velopp√© √©paules √©lastique",
      "Shrugs √©lastique",
      "Rotation externe √©lastique",
      "Rotation interne √©lastique",
      "Overhead press √©lastique"
  ],
      "Triceps": [
      "D√©velopp√© couch√© prise serr√©e",
      "D√©velopp√© d√©clin√© prise serr√©e",
      "D√©velopp√© assis prise serr√©e",
      "Barre front (skull crusher) barre EZ",
      "Barre front halt√®res",
      "Extension nuque halt√®re un bras",
      "Extension nuque halt√®res deux bras",
      "Extension triceps couch√© barre EZ",
      "Extension triceps couch√© halt√®res",
      "Extension triceps debout halt√®res",
      "Kickback triceps un bras halt√®re",
      "Kickback triceps deux bras halt√®res",
      "Kickback halt√®res sur banc inclin√©",
      "Close grip push-up (pompes prise serr√©e)",
      "JM press (m√©lange d√©velopp√© et skullcrusher)",
      "French press (barre EZ triceps)",
      "Extension unilat√©rale halt√®re assis",
      "Extension triceps allong√© barre droite",
      "D√©velopp√© militaire prise serr√©e (accent triceps)",
  
      "Extension triceps machine assis",
      "Extension triceps machine debout",
      "D√©velopp√© triceps machine convergente",
      "Dips assist√©s machine",
      "Press triceps machine Hammer Strength",
      "Extension triceps machine guid√©e",
      "Extension unilat√©rale triceps machine",
      "Extension triceps banc inclin√© machine",
      "Push-down machine triceps",
      "Kickback machine sp√©cifique",
  
      "Extension triceps poulie haute barre droite",
      "Extension triceps poulie haute corde",
      "Extension triceps poulie haute corde invers√©e",
      "Extension triceps poulie un bras",
      "Extension triceps poulie basse (reverse grip)",
      "Pushdown corde poulie haute",
      "Pushdown barre EZ poulie haute",
      "Kickback c√¢ble unilat√©ral",
      "Extension triceps √† la poulie horizontale",
      "Extension triceps bras crois√©s",
      "Extension triceps over rope (au-dessus de la t√™te)",
      "Extension triceps diagonale poulie",
      "Extension triceps unilat√©rale diagonale poulie",
      "Extension triceps invers√©e poulie (prise supination)",
      "Extension triceps allong√© poulie haute",
      "Extension triceps corde au-dessus de la t√™te",
  
      "Dips parall√®les",
      "Dips banc",
      "Pompes prise serr√©e (close grip push-ups)",
      "Pompes diamant",
      "Pompes triceps sur√©lev√©es",
      "Pompes mains rapproch√©es",
      "Pompes TRX triceps",
      "Pompes anneaux triceps",
      "Dips lest√©s",
      "Dips un bras assist√©s",
      "Pompes explosifs triceps",
      "Pompes murales triceps",
  
      "Extension triceps TRX",
      "Kickback TRX",
      "Pompes triceps TRX",
      "Extension triceps √©lastique deux bras",
      "Extension triceps √©lastique un bras",
      "Extension triceps overhead √©lastique",
      "Kickback √©lastique",
      "Pushdown √©lastique",
      "Pompes √©lastiques triceps",
      "Extension triceps bande circulaire",
      "Extension diagonale √©lastique",
      "Extension triceps tempo lent (√©lastique ou TRX)",
  
      "Dips sur barres parall√®les lest√©s",
      "Dips n√©gatifs",
      "Extension triceps isom√©trique",
      "French press unilat√©ral",
      "Extension triceps tempo lent 4-2-4",
      "Extension triceps drop set",
      "Extension triceps partielle basse",
      "Extension triceps partielle haute",
      "JM press barre EZ",
      "Extension triceps unilat√©rale lente"
  ],
      "Biceps":[
      "Curl barre droite",
      "Curl barre EZ",
      "Curl halt√®res altern√©s",
      "Curl halt√®res simultan√©s",
      "Curl marteau (hammer curl)",
      "Curl prise invers√©e (reverse curl)",
      "Curl concentr√© (concentration curl)",
      "Curl araign√©e (spider curl)",
      "Curl assis inclin√©",
      "Curl debout classique",
      "Curl debout unilat√©ral",
      "Curl Zottman",
      "Curl prise supination",
      "Curl rotation poignet",
      "Curl sur banc inclin√© halt√®res",
      "Curl unilat√©ral banc pr√©dicateur",
      "Curl deux bras banc pr√©dicateur",
      "Curl biceps debout barre EZ",
      "Curl barre guid√©e (Smith machine)",
      "Curl supination √† la barre trap",
      

      "Curl machine assis",
      "Curl machine debout",
      "Curl machine convergente",
      "Curl unilat√©ral machine",
      "Curl banc Larry Scott",
      "Curl machine preacher (banc inclin√©)",
      "Curl Hammer Strength machine",
      "Curl assist√© guid√©",
      "Curl c√¢ble machine sp√©cifique biceps",
  

      "Curl poulie basse deux bras",
      "Curl poulie basse un bras",
      "Curl poulie haute corde",
      "Curl poulie vis-√†-vis unilat√©ral",
      "Curl poulie crois√©e",
      "Curl vis-√†-vis double (biceps fly)",
      "Curl prise supination poulie basse",
      "Curl √† la poulie avec corde",
      "Curl unilat√©ral c√¢ble assis",
      "Curl unilat√©ral c√¢ble debout",
      "Curl biceps poulie invers√©e",

      "Tractions supination (chin-up)",
      "Tractions neutres (prise marteau)",
      "Tractions TRX supination",
      "Curl TRX (biceps TRX)",
      "Tractions assist√©es biceps",
      "Curl isom√©trique (maintien bras pli√©s traction)",
      "Curl bodyweight sous table (row biceps)",
      
 
      "Curl bande √©lastique deux bras",
      "Curl bande √©lastique un bras",
      "Curl marteau √©lastique",
      "Curl rotation √©lastique",
      "Curl isom√©trique √©lastique",
      "Curl prise invers√©e √©lastique",
      "Curl altern√© bande √©lastique",
      "Curl supination √©lastique",
      "Curl concentration √©lastique bande",
      "Curl Zottman √©lastique",
      
 
      "Curl √† la corde TRX unilat√©ral",
      "Curl prise neutre c√¢ble corde",
      "Curl 21 (m√©thode des 21 r√©p√©titions)",
      "Curl tempo lent (4-2-4)",
      "Curl drop set",
      "Curl unilat√©ral tempo lent",
      "Curl cheat (l√©g√®re aide du buste)",
      "Curl statique maintien haut",
      "Curl partiel haut",
      "Curl partiel bas"
  ],
      "Abdominaux": [
    
      "Crunch au sol",
      "Crunch sur banc",
      "Crunch sur ballon suisse",
      "Crunch invers√©",
      "Crunch jambes lev√©es",
      "Crunch mains derri√®re la t√™te",
      "Crunch oblique",
      "Crunch √† la poulie haute",
      "Crunch machine assis",
      "Crunch √† la poulie corde",
      "Crunch partiel haut",
      "Crunch tempo lent (4-2-4)",
      "Crunch avec rotation",
      "Crunch bicyclette",
      "Crunch sur Swiss ball bras tendus",
      "Crunch sur banc d√©clin√©",
      "Crunch lest√© disque",
      "Crunch unilat√©ral",
      "Crunch corde poulie genoux",
  
  
      "Relev√© de jambes au sol",
      "Relev√© de jambes suspendu",
      "Relev√© de jambes TRX",
      "Relev√© de genoux assis",
      "Relev√© de jambes sur banc inclin√©",
      "Relev√© de jambes barre fixe",
      "Relev√© de jambes poulie basse",
      "Relev√© de genoux avec torsion",
      "Relev√© de jambes avec halt√®re entre les pieds",
      "Relev√© de jambes couch√© au sol",
      "Relev√© de jambes lent contr√¥le",
      "Relev√© de jambes altern√©",
      "Relev√© de jambes lest√©",
      "Relev√© de jambes suspendu rotation",
      "Relev√© de genoux TRX",
  
  
      "Gainage frontal",
      "Gainage lat√©ral",
      "Gainage sur ballon suisse",
      "Gainage TRX",
      "Gainage dynamique (altern√© bras/jambes)",
      "Gainage sur coudes",
      "Gainage sur mains",
      "Gainage un bras/un pied",
      "Gainage planche invers√©e",
      "Gainage avec mont√©e de genoux",
      "Gainage Superman",
      "Gainage sur Swiss Ball avec roulement",
      "Gainage planche + rotation hanche",
      "Gainage lat√©ral avec √©l√©vation de hanche",
      "Gainage lat√©ral bras tendu",
      "Gainage avec mouvement bras",
      "Gainage sur roue abdominale (ab wheel rollout)",
      "Gainage avec ab roller",
      "Gainage TRX mountain climber",
      "Gainage coudes + step up",
  
     
      "Russian twist",
      "Russian twist lest√©",
      "Oblique crunch au sol",
      "Oblique crunch sur banc inclin√©",
      "Oblique TRX",
      "Rotation buste poulie haute",
      "Rotation buste poulie basse",
      "Twist m√©decine ball",
      "Side bend halt√®re (flexion lat√©rale)",
      "Side bend poulie",
      "Planche lat√©rale rotation bras",
      "Rotation buste c√¢ble unilat√©ral",
      "Rotation assis sur Swiss ball",
      "Rotation debout avec √©lastique",
      "Twist corde poulie haute",
      "Crunch oblique suspendu",
      "Side plank dips",
      "Windshield wipers (essuie-glaces)",
      "Oblique lev√©e de jambes suspendu rotation",
  
   
      "Ab coaster machine",
      "Crunch machine abdominals",
      "Rotation machine obliques",
      "Crunch poulie genoux",
      "Relev√© de jambes machine",
      "Incline bench sit-up machine",
      "Roman chair sit-up",
      "Banc d√©clin√© sit-up lest√©",
      "Crunch avec r√©sistance bande",
      "Crunch machine verticale",
      "Oblique twist machine",
      "Roue abdominale (ab wheel)",
      "Swiss Ball roll-out",
      "Cable woodchopper (poulie diagonale)",
      "Cable high-to-low woodchopper",
      "Cable low-to-high woodchopper",
      "Machine rotation assis",
      "Crunch machine Hammer Strength",
  
   
      "Mountain climbers",
      "V-ups",
      "Jackknife sit-up",
      "Leg raise kick",
      "Flutter kicks",
      "Scissor kicks",
      "Toe touch crunch",
      "Sit-up complet",
      "Sit-up lest√© disque",
      "Ab wheel roll-out",
      "Bear crawl",
      "Planche avec touche d‚Äô√©paule",
      "Dead bug",
      "Hollow hold",
      "Hollow rocks",
      "Bicycle crunch rapide",
      "Reverse crunch explosif",
      "L-sit au sol",
      "L-sit sur barres parall√®les",
      "Dragon flag (Bruce Lee)",
  
   
      "Knee tuck TRX",
      "Pike TRX",
      "Plank TRX + mountain climbers",
      "Ab rollout TRX",
      "Oblique twist TRX",
      "Ab crunch √©lastique",
      "Crunch rotation √©lastique",
      "Gainage avec √©lastique tirage bras",
      "Relev√© de jambes √©lastique",
      "Crunch debout √©lastique",
      "Woodchopper √©lastique",
      "Russian twist √©lastique",
      "Crunch isom√©trique √©lastique",
      "Extension abdos corde √©lastique",
  
  
      "Circuit abdos 4x30s (haut, bas, obliques, gainage)",
      "Tabata abdos 8x20s",
      "AMRAP 10 min abdos",
      "HIIT abdominaux 20/10",
      "Combo crunch + relev√© jambes",
      "Combo plank + mountain climber",
      "Combo V-up + Russian twist",
      "Superset crunch + ab wheel",
      "Superset oblique + plank",
      "Circuit 5 exercices abdos",
      "Finisher abdos br√ªlants 5 min"
  ],
      "Cardio" : [
      "Course sur tapis",
      "Course en ext√©rieur",
      "Course en c√¥te",
      "Sprint court (100 m)",
      "Sprint fractionn√© (HIIT run)",
      "Jogging d'endurance",
      "Fartlek (course √† intensit√© variable)",
      "Mont√©es d'escaliers",
      "Course sur piste",
      "Sprint sur tapis motoris√©",
      "Marche rapide sur tapis",
      "Course en pente sur tapis",
      "Course sur plage ou sable",
      "Course en for√™t (trail)",
      "Course intervalle 30/30",
  
      "V√©lo elliptique",
      "V√©lo d‚Äôappartement",
      "V√©lo de route",
      "V√©lo spinning",
      "V√©lo en c√¥te",
      "Sprints v√©lo",
      "HIIT v√©lo (20s/10s Tabata)",
      "V√©lo elliptique bras et jambes",
      "V√©lo d‚Äôint√©rieur fractionn√©",
      "AirBike (v√©lo √† r√©sistance d‚Äôair)",
  
      "Rameur",
      "SkiErg",
      "Escalator machine (stair master)",
      "Stepper",
      "Mont√©e de marches machine",
      "Assault bike",
      "Rameur fractionn√© (interval training)",
      "Rameur en endurance longue",
      "Rameur puissance (s√©ries courtes)",
  
      "Burpees",
      "Mountain climbers",
      "Jumping jacks",
      "Squat jump",
      "Fentes saut√©es",
      "Pompes explosives",
      "High knees (mont√©es de genoux)",
      "Butt kicks (talons-fesses)",
      "Tuck jumps",
      "Burpees avec pompes",
      "Burpees avec saut √©toile",
      "Jump lunges",
      "Skater jumps (patineur)",
      "Saut corde √† pied joint",
      "Saut corde altern√©",
      "Saut corde double unders",
      "Shadow boxing",
      "Knee push-up cardio",
      "Pompes + mountain climbers",
      "Jump squats tempo rapide",
  
      "Tabata 20/10",
      "Circuit 30/30",
      "AMRAP 10 min (as many rounds as possible)",
      "EMOM (Every Minute On the Minute)",
      "Complexe kettlebell cardio",
      "Circuit poids du corps",
      "Sprint corde √† sauter + burpees",
      "Circuit fractionn√© haut/bas du corps",
      "HIIT 4x4 minutes (m√©thode norv√©gienne)",
      "Entra√Ænement pyramidal cardio",
      "Cardio boxing circuit",
      "HIIT full body 15 min",
      "Circuit cardio au poids du corps (5 exercices encha√Æn√©s)",
  
      "Corde √† sauter",
      "Shadow boxing",
      "Boxe sur sac lourd",
      "Boxe au sac vitesse",
      "Boxe anglaise fractionn√©e",
      "Kickboxing circuit",
      "Muay Thai shadow",
      "Corde √† sauter double",
      "Shadow boxing 3 rounds",
      "Cardio box Tabata",
  
      "Mountain climbers TRX",
      "Burpees TRX",
      "Squat jump TRX",
      "Pompes TRX dynamiques",
      "Row TRX explosif",
      "Course √©lastique r√©sistance",
      "Sprint √©lastique",
      "Fente saut√©e TRX",
      "Corde √† sauter √©lastique",
      "Burpees √©lastiques",
      "Knee drive √©lastique",
      "Course sur place √©lastique",
  
  
      "Corde ondulatoire (battle rope)",
      "Pouss√©e de tra√Æneau (sled push)",
      "Tirage de tra√Æneau (sled pull)",
      "Course avec parachute",
      "Mont√©e de colline sprint",
      "Entra√Ænement escaliers",
      "Circuit urbain (banc, escalier, trottoir)",
      "Course intervalle 15/45",
      "Marche rapide avec charge l√©g√®re (rucking)",
      "Saut de bo√Æte (box jump)",
      "Circuit cardio plage",
      "Sprint c√¥ne en aller-retour",
      "Course fractionn√©e avec gilet lest√©",
      "Cardio circuit poids du corps 20 min"
  ]
    };
  
    function updateExercises() {
      const type = document.getElementById('type').value;
      const exerciseSelect = document.getElementById('exercise');
      exerciseSelect.innerHTML = '<option value="">Choisir un exercice</option>';
  
      if (exercisesByType[type]) {
        exercisesByType[type].forEach(ex => {
          const opt = document.createElement('option');
          opt.value = ex;
          opt.textContent = ex;
          exerciseSelect.appendChild(opt);
        });
      }
    }
  </script>
  
  
  <!-- Script JS pour exercices dynamiques -->

  
  
    <!-- üìã Derni√®res activit√©s -->
    <section class="bg-neutral-900 rounded-2xl p-6 border border-neutral-800">
      <div class="flex justify-between items-center cursor-pointer mb-4" onclick="toggleActivities(this)">
        <h3 class="text-xl font-semibold flex items-center gap-2">
          <i data-lucide="activity" class="text-red-500"></i> Derni√®res activit√©s
        </h3>
        <button class="toggle-btn text-neutral-400 hover:text-red-400 transition">
          <i data-lucide="chevron-down"></i>
        </button>
      </div>
    
      <div class="activities-list mt-3 space-y-3">
        {% if workouts %}
          <ul class="space-y-3 text-neutral-300">
            {% for w in workouts %}
            <li class="flex justify-between items-center border-b border-neutral-800 pb-2">
              <div>
                <span>{{ w.date.strftime('%d/%m/%Y') }} ‚Äì {{ w.type }}</span>
                <span class="text-red-500 font-semibold ml-2">{{ w.duration }} min</span>
              </div>
              <form action="{{ url_for('delete_workout', id=w.id) }}" method="POST" onsubmit="return confirm('Supprimer cette activit√© ?');">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                <button type="submit" class="text-neutral-400 hover:text-red-500 transition">
                  <i data-lucide="trash-2"></i>
                </button>
              </form>
            </li>
            {% endfor %}
          </ul>
        {% else %}
          <p class="text-neutral-500 italic">Aucun entra√Ænement enregistr√© pour l‚Äôinstant.</p>
        {% endif %}
      </div>
    </section>
    
  </main>
  
  <section class="bg-neutral-900 rounded-2xl p-6 border border-neutral-800 text-center mt-8">
    <h3 class="text-xl font-semibold mb-2 flex justify-center items-center gap-2">
      <i data-lucide="flame" class="text-red-500"></i>
      Total des calories br√ªl√©es üî•
    </h3>
  
    {% if total_calories %}
      <p class="text-3xl font-bold text-green-400">{{ total_calories }} kcal</p>
      <p class="text-neutral-400 text-sm mt-2">Estimation bas√©e sur la dur√©e et le poids</p>
    {% else %}
      <p class="text-neutral-500 italic">Aucune donn√©e disponible pour l‚Äôinstant.</p>
    {% endif %}
  </section>
  
  
  <footer class="text-center text-neutral-500 text-sm py-6 border-t border-neutral-800">
    ¬© {{ datetime.utcnow().year }} FitSafe AI ‚Äì Tous droits r√©serv√©s.
  </footer>

  <!-- ===== DATA CHART SAFE JSON ===== -->
  <script id="chart-data" type="application/json">
    {
      "labels": {{ chart_labels | tojson }},
      "data": {{ chart_data | tojson }}
    }
  </script>

  <!-- ===== SCRIPTS ===== -->
  <script>
    lucide.createIcons();

    const chartData = JSON.parse(document.getElementById('chart-data').textContent);
    const labels = chartData.labels;
    const data = chartData.data;

    const ctx = document.getElementById('workoutChart').getContext('2d');
    const workoutChart = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: labels,
        datasets: [{
          label: 'Dur√©e totale (min)',
          data: data,
          backgroundColor: [
            'rgba(239, 68, 68, 0.8)',
            'rgba(234, 88, 12, 0.8)',
            'rgba(59, 130, 246, 0.8)',
            'rgba(34, 197, 94, 0.8)',
            'rgba(168, 85, 247, 0.8)'
          ],
          borderWidth: 1,
          borderRadius: 6
        }]
      },
      options: {
        plugins: { legend: { labels: { color: '#ddd' } } },
        scales: {
          x: { ticks: { color: '#aaa' }, grid: { color: 'rgba(255,255,255,0.1)' } },
          y: { ticks: { color: '#aaa' }, grid: { color: 'rgba(255,255,255,0.1)' }, beginAtZero: true }
        }
      }
    });
  </script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const el = document.querySelector('.text-5xl.font-bold');
      if (!el) return;
      const target = parseInt(el.textContent);
      let current = 0;
      const interval = setInterval(() => {
        if (current < target) {
          current++;
          el.textContent = current + "%";
        } else clearInterval(interval);
      }, 15);
    });
  </script>
  <script>
    function toggleSession(header) {
      const session = header.closest('.mb-6'); // chaque bloc de s√©ance
      const list = session.querySelector('.exercise-list');
      const icon = header.querySelector('.toggle-btn i');
  
      if (!list) return;
  
      if (list.style.maxHeight && list.style.maxHeight !== '0px') {
        // Fermer
        list.style.maxHeight = '0';
        list.style.opacity = '0';
        icon.setAttribute('data-lucide', 'chevron-right');
      } else {
        // Ouvrir
        list.style.maxHeight = list.scrollHeight + 'px';
        list.style.opacity = '1';
        icon.setAttribute('data-lucide', 'chevron-down');
      }
  
      lucide.createIcons();
    }
  
    // Par d√©faut : tout ferm√© sauf la premi√®re s√©ance
    document.addEventListener("DOMContentLoaded", () => {
      document.querySelectorAll('.exercise-list').forEach((list, i) => {
        if (i === 0) {
          list.style.maxHeight = list.scrollHeight + 'px';
          list.style.opacity = '1';
        } else {
          list.style.maxHeight = '0';
          list.style.opacity = '0';
        }
        list.style.transition = 'max-height 0.4s ease, opacity 0.3s ease';
        list.style.overflow = 'hidden';
      });
    });
  </script>
  <script>
    function toggleActivities(header) {
      const section = header.closest('section');
      const list = section.querySelector('.activities-list');
      const icon = header.querySelector('.toggle-btn i');
  
      if (!list) return;
  
      if (list.style.maxHeight && list.style.maxHeight !== '0px') {
        // Fermer
        list.style.maxHeight = '0';
        list.style.opacity = '0';
        icon.setAttribute('data-lucide', 'chevron-right');
      } else {
        // Ouvrir
        list.style.maxHeight = list.scrollHeight + 'px';
        list.style.opacity = '1';
        icon.setAttribute('data-lucide', 'chevron-down');
      }
  
      lucide.createIcons();
    }
  
    // Par d√©faut : section ouverte
    document.addEventListener("DOMContentLoaded", () => {
      const list = document.querySelector('.activities-list');
      if (list) {
        list.style.maxHeight = list.scrollHeight + 'px';
        list.style.opacity = '1';
        list.style.transition = 'max-height 0.4s ease, opacity 0.3s ease';
        list.style.overflow = 'hidden';
      }
    });
  </script>
  
  
    
</body>
</html>
